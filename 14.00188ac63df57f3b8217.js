(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"O+XU":function(t,e,s){"use strict";s.r(e),s.d(e,"RecurrenceModule",function(){return x});var i=s("M0ag"),n=s("tyNb"),c=s("xK1T"),a=s("fXoL"),o=s("Ac7g"),r=s("PScX"),u=s("JA5x"),d=s("B+r4"),l=s("ok2U"),m=s("DGaY"),p=s("ofXK");const h=["st"];function b(t,e){if(1&t&&(a.Wb(0,"span",7),a.Kc(1),a.Vb()),2&t){const t=e.$implicit;a.oc("ngClass","expense"===t.transaction.type?"text-red":"text-green"),a.Cb(1),a.Oc(" ","expense"===t.transaction.type?"-":""," ",t.transaction.currency_code," ",t.transaction.currency_amount," ")}}const g=function(){return{xs:6,sm:16,md:24,lg:32}},f=[{path:"index",component:(()=>{class t{constructor(t,e,s){this.http=t,this.modal=e,this.message=s,this.loading=!0,this.list=[],this.q={page:1,name:""},this.url="/api/recurrences",this.searchSchema={properties:{name:{type:"string",title:"\u540d\u79f0"}}},this.columns=[{title:"\u540d\u79f0 ",index:"name"},{title:"\u8d26\u672c",index:"transaction.ledger_name"},{title:"\u4ea4\u6613",render:"custom"},{title:"\u9891\u7387",index:"frequency_text"},{title:"\u65f6\u95f4\u503c",index:"schedule"},{title:"\u5f00\u59cb\u65f6\u95f4",type:"date",index:"started_at",dateFormat:"yyyy-MM-dd"},{title:"\u4e0b\u6b21\u6267\u884c\u65f6\u95f4",type:"date",index:"execution_date",dateFormat:"yyyy-MM-dd"},{title:"\u72b6\u6001",type:"badge",index:"status",badge:{active:{text:"\u542f\u7528",color:"success"},unactivated:{text:"\u505c\u7528",color:"default"}}},{title:"\u66f4\u65b0\u65f6\u95f4",type:"date",index:"updated_at"},{title:"",buttons:[{icon:"edit",type:"modal",click:t=>this.form(t)},{icon:"play-circle",click:t=>this.updateStatus(t,"active"),iif:t=>"unactivated"===t.status,tooltip:"\u542f\u7528"},{icon:"pause-circle",click:t=>this.updateStatus(t,"unactivated"),iif:t=>"active"===t.status,tooltip:"\u505c\u7528"},{icon:"delete",type:"del",pop:{title:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",okType:"danger"},click:(t,e,s)=>{this.delete(t),s.removeRow(t)}}]}]}ngOnInit(){this.getData()}getData(){this.loading=!0,this.http.get(this.url,this.q).subscribe(t=>{this.list=t.data.items,this.loading=!1})}form(t={}){this.modal.create(c.a,{record:t},{size:"md"}).subscribe(t=>{this.getData()})}copy(t){this.http.post(`${this.url}/${t.id}/copy`).subscribe(t=>{0===(null==t?void 0:t.code)?(this.list.splice(0,0,t.data),this.list=[...this.list],this.message.success("\u590d\u5236\u6210\u529f")):this.message.warning(null==t?void 0:t.message)})}delete(t){this.http.delete(`${this.url}/${t.id}`).subscribe(t=>{0===(null==t?void 0:t.code)?this.message.success("\u5220\u9664\u6210\u529f"):this.message.warning(null==t?void 0:t.message)})}updateStatus(t,e){this.http.put(`${this.url}/${t.id}/status`,{status:e}).subscribe(t=>{0===(null==t?void 0:t.code)?(this.getData(),this.message.success("\u66f4\u65b0\u6210\u529f")):this.message.warning(null==t?void 0:t.message)})}submit(t){this.q.name=t.name,this.getData()}}return t.\u0275fac=function(e){return new(e||t)(a.Qb(o.p),a.Qb(o.j),a.Qb(r.e))},t.\u0275cmp=a.Kb({type:t,selectors:[["app-recurrence-index"]],viewQuery:function(t,e){if(1&t&&a.Pc(h,1),2&t){let t;a.wc(t=a.ec())&&(e.st=t.first)}},decls:9,vars:5,consts:[[1,"pt-lg"],["nz-row","",3,"nzGutter"],["nz-col",""],["mode","search",3,"schema","formSubmit","formReset"],[3,"data","columns"],["st",""],["st-row","custom"],[3,"ngClass"]],template:function(t,e){if(1&t){const t=a.Xb();a.Wb(0,"div",0),a.Wb(1,"nz-card"),a.Wb(2,"div",1),a.Wb(3,"div",2),a.Wb(4,"sf",3),a.dc("formSubmit",function(t){return e.submit(t)})("formReset",function(e){return a.Ac(t),a.xc(7).reset(e)}),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Wb(5,"nz-card"),a.Wb(6,"st",4,5),a.Ic(8,b,2,4,"ng-template",6),a.Vb(),a.Vb()}2&t&&(a.Cb(2),a.oc("nzGutter",a.rc(4,g)),a.Cb(2),a.oc("schema",e.searchSchema),a.Cb(2),a.oc("data",e.list)("columns",e.columns))},directives:[u.a,d.c,d.a,l.b,m.a,m.c,p.m],encapsulation:2}),t})()}];let y=(()=>{class t{}return t.\u0275mod=a.Ob({type:t}),t.\u0275inj=a.Nb({factory:function(e){return new(e||t)},imports:[[n.n.forChild(f)],n.n]}),t})(),x=(()=>{class t{}return t.\u0275mod=a.Ob({type:t}),t.\u0275inj=a.Nb({factory:function(e){return new(e||t)},imports:[[i.b,y]]}),t})()}}]);