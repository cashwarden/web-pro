{"version":3,"sources":["./src/app/routes/category/index/index.component.ts","./src/app/routes/category/index/index.component.html","./src/app/routes/category/category.module.ts","./src/app/routes/category/category-routing.module.ts","./src/app/routes/category/form/form.component.ts","./src/app/routes/category/form/form.component.html"],"names":[],"mappings":"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","file":"category-category-module.js","sourcesContent":["import { ChangeDetectorRef, Component, OnInit, ViewChild } from '@angular/core';\nimport { STColumn, STComponent } from '@delon/abc/st';\nimport { CacheService } from '@delon/cache';\nimport { SFSchema, SFSelectWidgetSchema } from '@delon/form';\nimport { ModalHelper, _HttpClient } from '@delon/theme';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { map } from 'rxjs/operators';\nimport { params } from 'src/app/shared/params';\nimport { CategoryFormComponent } from './../form/form.component';\n\n@Component({\n  selector: 'app-category-index',\n  templateUrl: './index.component.html',\n})\nexport class CategoryIndexComponent implements OnInit {\n  @ViewChild('st', { static: false }) st: STComponent;\n\n  loading = true;\n  pagination: {};\n  list: any[] = [];\n  q = {\n    page: 1,\n    pageSize: 100,\n    name: '',\n    transaction_type: '',\n    ledger_id: 0,\n  };\n  transactionTypes: any[] = [];\n\n  searchSchema: SFSchema = {\n    properties: {\n      name: {\n        type: 'string',\n        title: '名称',\n      },\n      transaction_type: {\n        type: 'string',\n        title: '交易类型',\n        default: '',\n        ui: {\n          widget: 'select',\n          asyncData: () => {\n            return this.http.get('/api/transactions/types').pipe(\n              map((res) => {\n                if (res.code !== 0) {\n                  this.msg.warning(res.message);\n                  return;\n                }\n                return res.data.map((item: any) => {\n                  return { value: item.type, label: item.name };\n                });\n              }),\n            );\n          },\n        } as SFSelectWidgetSchema,\n      },\n    },\n  };\n  columns: STColumn[] = [\n    { title: '名称', renderTitle: 'customTitle', render: 'custom' },\n    { title: '关键词', index: 'keywords' },\n    { title: '交易类型', index: 'transaction_type_text' },\n    {\n      title: '默认',\n      type: 'badge',\n      index: 'default',\n      badge: {\n        true: { text: '是', color: 'success' },\n        false: { text: '否', color: 'default' },\n      },\n    },\n    { title: '排序', index: 'sort' },\n    { title: '时间', type: 'date', index: 'updated_at' },\n    {\n      title: '',\n      buttons: [\n        {\n          icon: 'edit',\n          click: (item: any) => this.form(item),\n          iif: (record) => !['adjust', 'transfer'].includes(record.transaction_type),\n          iifBehavior: 'disabled',\n        },\n        {\n          icon: 'delete',\n          type: 'del',\n          pop: {\n            title: '确定要删除吗？',\n            okType: 'danger',\n          },\n          click: (record, _modal, comp) => {\n            this.delete(record, comp);\n          },\n        },\n      ],\n    },\n  ];\n\n  constructor(private http: _HttpClient, private modal: ModalHelper, private msg: NzMessageService, private cache: CacheService) { }\n\n  ngOnInit() {\n    this.getData();\n  }\n\n  getData(): void {\n    this.loading = true;\n    this.q.ledger_id = this.cache.getNone(params.cacheKey.defaultIdLedger);\n    this.http.get('/api/categories', this.q).subscribe((res) => {\n      this.list = res.data.items;\n      this.pagination = res.data._meta;\n      this.loading = false;\n    });\n  }\n\n  form(record: { id?: number } = {}): void {\n    this.modal.create(CategoryFormComponent, { record }, { size: 'md' }).subscribe((res) => {\n      if (record.id) {\n        // record = res;\n        this.getData();\n      } else {\n        this.list.splice(0, 0, res);\n        this.list = [...this.list];\n      }\n    });\n  }\n\n  delete(record: any, comp): void {\n    this.http.delete(`/api/categories/${record.id}`).subscribe((res) => {\n      if (res?.code !== 0) {\n        this.msg.warning(res?.message);\n        return;\n      }\n      // tslint:disable-next-line: no-non-null-assertion\n      comp!.removeRow(record);\n      // this.getData();\n      this.msg.success('删除成功');\n    });\n  }\n\n  submit(value: any): void {\n    this.q = value;\n    this.getData();\n  }\n}\n","<div class=\"pt-lg\">\n  <nz-card>\n    <div nz-row [nzGutter]=\"{ xs: 6, sm: 16, md: 24, lg: 32 }\">\n      <div nz-col>\n        <sf mode=\"search\" [schema]=\"searchSchema\" (formSubmit)=\"submit($event)\" (formReset)=\"st.reset($event)\"></sf>\n      </div>\n      <div nz-col>\n        <button (click)=\"form()\" nz-button nzType=\"primary\">新建</button>\n      </div>\n    </div>\n  </nz-card>\n</div>\n\n<nz-card>\n  <st #st [data]=\"list\" [columns]=\"columns\">\n    <ng-template st-row=\"customTitle\" type=\"title\" let-c>\n      {{ c.title.text }}\n    </ng-template>\n    <ng-template st-row=\"custom\" let-item let-index=\"index\">\n      <i nz-icon nzIconfont=\"icon-{{ item.icon_name }}\" class=\"icon-sm\"></i> {{ item.name }}\n    </ng-template>\n  </st>\n</nz-card>\n","import { NgModule } from '@angular/core';\nimport { SharedModule } from '@shared';\nimport { CategoryRoutingModule } from './category-routing.module';\nimport { CategoryIndexComponent } from './index/index.component';\nimport { CategoryFormComponent } from './form/form.component';\n\nconst COMPONENTS = [CategoryIndexComponent];\nconst COMPONENTS_NOROUNT = [CategoryFormComponent];\n\n@NgModule({\n  imports: [SharedModule, CategoryRoutingModule],\n  declarations: [...COMPONENTS, ...COMPONENTS_NOROUNT],\n})\nexport class CategoryModule {}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { CategoryIndexComponent } from './index/index.component';\n\nconst routes: Routes = [{ path: 'index', component: CategoryIndexComponent }];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CategoryRoutingModule {}\n","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { CacheService } from '@delon/cache';\nimport { _HttpClient } from '@delon/theme';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { NzModalRef } from 'ng-zorro-antd/modal';\nimport { params } from 'src/app/shared/params';\n\n@Component({\n  selector: 'app-category-form',\n  templateUrl: './form.component.html',\n})\nexport class CategoryFormComponent implements OnInit {\n  record: any = {};\n  ledger_id = 0;\n  form = {\n    name: '',\n    keywords: [],\n    transaction_type: 'expense',\n    sort: 99,\n    icon_name: '',\n    default: false,\n  };\n  icons: [];\n\n  constructor(\n    private modal: NzModalRef,\n    private msgSrv: NzMessageService,\n    public http: _HttpClient,\n    private cdr: ChangeDetectorRef,\n    private cache: CacheService,\n  ) {}\n\n  ngOnInit(): void {\n    this.loadIcons();\n    if (this.record.id) {\n      this.form = this.record;\n    }\n    this.ledger_id = this.cache.getNone(params.cacheKey.defaultIdLedger);\n  }\n\n  save(value: any) {\n    const url = this.record.id ? `/${this.record.id}` : '';\n    const method = this.record.id ? 'put' : 'post';\n    value.ledger_id = this.ledger_id;\n    this.http.request(method, `/api/categories${url}`, { body: value }).subscribe((res: any) => {\n      if (res.code !== 0) {\n        this.msgSrv.warning(res.message);\n        return;\n      }\n      this.msgSrv.success('保存成功');\n      this.modal.close(res.data);\n    });\n  }\n\n  loadIcons(): void {\n    this.http.get('/api/icons').subscribe((res: any) => {\n      if (res.code !== 0) {\n        this.msgSrv.warning(res.message);\n        return;\n      }\n      this.icons = res.data;\n      this.cdr.detectChanges();\n    });\n  }\n\n  close() {\n    this.modal.destroy();\n  }\n}\n","<div class=\"modal-header\">\n  <div class=\"modal-title\">编辑 {{ record.name }} 分类</div>\n</div>\n\n<form nz-form #f=\"ngForm\" se-container=\"1\" (ngSubmit)=\"save(form)\" labelWidth=\"100\">\n  <se label=\"名称\">\n    <input type=\"text\" nz-input [(ngModel)]=\"form.name\" name=\"name\" required maxlength=\"32\" />\n  </se>\n  <se label=\"交易类型\">\n    <nz-radio-group [(ngModel)]=\"form.transaction_type\" nzButtonStyle=\"solid\" name=\"type\">\n      <label nz-radio-button nzValue=\"expense\"> <span>支出</span> </label>\n      <label nz-radio-button nzValue=\"income\"> <span>收入</span> </label>\n    </nz-radio-group>\n  </se>\n\n  <se label=\"关键词\">\n    <nz-select [(ngModel)]=\"form.keywords\" nzMode=\"tags\" name=\"keywords\">\n      <nz-option [nzLabel]=\"i.label\" [nzValue]=\"i.value\" *ngFor=\"let i of []\"> </nz-option>\n    </nz-select>\n  </se>\n\n  <se label=\"图标\">\n    <nz-radio-group [(ngModel)]=\"form.icon_name\" name=\"icon_name\" required>\n      <label nz-radio [nzValue]=\"i\" *ngFor=\"let i of icons\"> <i nz-icon nzIconfont=\"icon-{{ i }}\" class=\"icon-md\"></i> </label>\n    </nz-radio-group>\n  </se>\n\n  <se label=\"默认账号\" col=\"1\">\n    <nz-switch [(ngModel)]=\"form.default\" name=\"default\"></nz-switch>\n  </se>\n\n  <se label=\"排序\">\n    <input type=\"number\" nz-input [(ngModel)]=\"form.sort\" name=\"sort\" required />\n  </se>\n  <se col=\"1\">\n    <button nz-button nzType=\"primary\" [disabled]=\"f.invalid\">保存</button>\n    <button nz-button type=\"button\" (click)=\"close()\">关闭</button>\n  </se>\n</form>\n"],"sourceRoot":"webpack:///"}