(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{rSnh:function(n,t,e){"use strict";e.r(t),e.d(t,"AccountModule",function(){return N});var c=e("M0ag"),i=e("tyNb"),a=e("IbCd"),o=e("fXoL"),s=e("Ac7g"),b=e("PScX"),l=e("JA5x"),r=e("B+r4"),u=e("3Pt+"),d=e("ocnv"),p=e("O3k0"),g=e("PTRe"),h=e("zAKX"),z=e("ofXK"),m=e("OzZK"),f=e("RwU8"),v=e("C2AL"),V=e("FwiY"),C=e("Ff2k"),W=e("ngc+"),y=e("KupA"),w=e("0lRi"),T=e("ZyQt");function L(n,t){if(1&n&&(o.Wb(0,"nz-option",20),o.Rb(1,"i",21),o.Kc(2),o.Vb()),2&n){const n=t.$implicit;o.oc("nzLabel",n.name)("nzValue",n.type),o.Cb(1),o.qc("nzIconfont","icon-",n.type,""),o.Cb(1),o.Mc(" ",n.name," ")}}function I(n,t){if(1&n&&o.Rb(0,"nz-option",22),2&n){const n=t.$implicit;o.oc("nzLabel",n.label)("nzValue",n.value)}}function x(n,t){if(1&n&&o.Rb(0,"nz-option",22),2&n){const n=t.$implicit;o.oc("nzLabel",n.label)("nzValue",n.value)}}function S(n,t){if(1&n&&(o.Wb(0,"a",28),o.Kc(1),o.Vb()),2&n){const n=o.gc().$implicit;o.qc("routerLink","/account/view/",n.id,""),o.Cb(1),o.Lc(n.name)}}function K(n,t){if(1&n){const n=o.Xb();o.Wb(0,"i",29),o.dc("click",function(){o.Ac(n);const t=o.gc().$implicit;return o.gc().form(t)}),o.Vb()}if(2&n){const n=o.gc().$implicit;o.qc("nzIconfont","icon-",n.type,"")}}function A(n,t){if(1&n){const n=o.Xb();o.Wb(0,"span",30),o.Wb(1,"i",31),o.dc("click",function(){o.Ac(n);const t=o.gc().$implicit;return o.gc().form(t)}),o.Vb(),o.Vb(),o.Wb(2,"span",30),o.Wb(3,"i",32),o.dc("nzOnConfirm",function(){o.Ac(n);const t=o.gc().$implicit;return o.gc().delete(t)}),o.Vb(),o.Vb()}}function k(n,t){if(1&n&&(o.Wb(0,"nz-tag"),o.Kc(1),o.Vb()),2&n){const n=t.$implicit;o.Cb(1),o.Lc(n)}}function q(n,t){if(1&n&&(o.Wb(0,"sv-container",33),o.Wb(1,"sv",34),o.Kc(2),o.Vb(),o.Wb(3,"sv",35),o.Kc(4),o.Vb(),o.Wb(5,"sv",36),o.Kc(6),o.Vb(),o.Wb(7,"sv",37),o.Kc(8),o.Vb(),o.Wb(9,"sv",38),o.Ic(10,k,2,1,"nz-tag",39),o.Vb(),o.Wb(11,"sv",40),o.Kc(12),o.Vb(),o.Vb()),2&n){const n=o.gc().$implicit;o.Cb(2),o.Lc(n.type_name),o.Cb(2),o.Lc(n.status_txt),o.Cb(2),o.Lc(n.default?"\u662f":"\u5426"),o.Cb(2),o.Lc(n.exclude_from_stats?"\u662f":"\u5426"),o.Cb(2),o.oc("ngForOf",n.keywords),o.Cb(2),o.Lc(n.remark)}}function O(n,t){if(1&n&&(o.Wb(0,"g2-card",23),o.hc(1,"_currency"),o.Ic(2,S,2,2,"ng-template",null,24,o.Jc),o.Ic(4,K,1,1,"ng-template",null,25,o.Jc),o.Ic(6,A,4,0,"ng-template",null,26,o.Jc),o.Ic(8,q,13,6,"ng-template",null,27,o.Jc),o.Vb()),2&n){const n=t.$implicit,e=o.xc(3),c=o.xc(5),i=o.xc(7),a=o.xc(9);o.oc("title",e)("bordered",!0)("total",o.ic(1,6,n.balance))("footer",a)("avatar",c)("action",i)}}const M=function(){return{gutter:24,lg:8,md:12,sm:24,xs:24}};let R=(()=>{class n{constructor(n,t,e,c){this.http=n,this.msg=t,this.modal=e,this.cdr=c,this.q={page:1,pageSize:50,status:"active"},this.accountSorts=[{value:"-balance_cent",label:"\u4f59\u989d\u5012\u5e8f"},{value:"balance_cent",label:"\u4f59\u989d\u6b63\u5e8f"}],this.accountStatus=[{value:"active",label:"\u6b63\u5e38"},{value:"unactivated",label:"\u51bb\u7ed3"}],this.accountTypes=[],this.list=[],this.loading=!0}ngOnInit(){this.getOverview(),this.getData(),this.getAccountTypes()}getData(){this.loading=!0;const n={};Object.entries(this.q).filter(([,n])=>null!==n).map(([t,e])=>n[t]=e),this.q=n,this.http.get("/api/accounts",this.q).subscribe(n=>{this.list=n.data.items,this.loading=!1,this.cdr.detectChanges()})}getAccountTypes(){this.http.get("/api/accounts/types").subscribe(n=>{n.data&&(this.accountTypes=n.data,this.cdr.detectChanges())})}getOverview(){this.http.get("/api/accounts/overview").subscribe(n=>{this.overview=n.data,this.cdr.detectChanges()})}search(){this.getData()}reset(){this.q={page:1,pageSize:50},this.getData()}form(n={}){this.modal.create(a.a,{record:n,accountTypes:this.accountTypes},{size:"md"}).subscribe(n=>{this.getData(),this.getOverview(),this.cdr.detectChanges()})}delete(n){this.http.delete(`/api/accounts/${n.id}`).subscribe(n=>{0===(null==n?void 0:n.code)?(this.getData(),this.getOverview(),this.msg.success("\u5220\u9664\u6210\u529f")):this.msg.warning(null==n?void 0:n.message)})}}return n.\u0275fac=function(t){return new(t||n)(o.Qb(s.p),o.Qb(b.e),o.Qb(s.j),o.Qb(o.h))},n.\u0275cmp=o.Kb({type:n,selectors:[["app-account-index"]],decls:50,vars:31,consts:[[1,"pt-md"],["nz-row",""],["nz-col","",1,"header-info",3,"nzXs","nzSm"],[1,"text-grey-dark"],[1,"d-block","display-2"],["nz-form","","se-container","","size","compact","gutter","24",3,"labelWidth","ngSubmit"],["f","ngForm"],["col","6"],["nz-input","","name","name","placeholder","\u641c\u7d22\u8d26\u6237\u540d\u79f0",3,"ngModel","ngModelChange"],["name","type","nzShowSearch","","nzAllowClear","",3,"ngModel","nzPlaceHolder","ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["name","status","nzShowSearch","","nzAllowClear","",3,"ngModel","nzPlaceHolder","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["name","sort","nzShowSearch","","nzAllowClear","",3,"ngModel","nzPlaceHolder","ngModelChange"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",3,"click"],["nz-button","",3,"nzType","click"],["nz-icon","","nzType","plus"],[3,"nzDataSource","nzLoading","nzRenderItem","nzGrid"],["item",""],["nzCustomContent","",3,"nzLabel","nzValue"],["nz-icon","",3,"nzIconfont"],[3,"nzLabel","nzValue"],[3,"title","bordered","total","footer","avatar","action"],["title",""],["avatar",""],["action",""],["footer",""],[3,"routerLink"],["nz-icon","",1,"icon-md",3,"nzIconfont","click"],[1,"pl-sm"],["nz-icon","","nzType","edit",3,"click"],["nz-icon","","nzType","delete","nz-popconfirm","","nzPopconfirmTitle","\u786e\u5b9a\u8981\u5220\u9664\u5e10\u6237\u5417\uff1f\u5982\u679c\u5e10\u6237\u88ab\u5220\u9664\uff0c\u6240\u6709\u6d89\u53ca\u7684\u4ea4\u6613\u3001\u89c4\u5219\u548c\u5b9a\u65f6\u914d\u7f6e\u5c06\u6c38\u8fdc\u5931\u53bb\u3002","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["size","small","col","2"],["label","\u7c7b\u578b"],["label","\u72b6\u6001"],["label","\u9ed8\u8ba4\u8d26\u53f7"],["label","\u4e0d\u8ba1\u5165\u7edf\u8ba1"],["label","\u5173\u952e\u8bcd","col","1"],[4,"ngFor","ngForOf"],["label","\u5907\u6ce8","col","1"]],template:function(n,t){if(1&n&&(o.Wb(0,"div",0),o.Wb(1,"nz-card"),o.Wb(2,"div",1),o.Wb(3,"div",2),o.Wb(4,"span",3),o.Kc(5,"\u51c0\u8d44\u4ea7"),o.Vb(),o.Wb(6,"span",4),o.Kc(7),o.Vb(),o.Rb(8,"em"),o.Vb(),o.Wb(9,"div",2),o.Wb(10,"span",3),o.Kc(11,"\u8d1f\u503a"),o.Vb(),o.Wb(12,"span",4),o.Kc(13),o.Vb(),o.Rb(14,"em"),o.Vb(),o.Wb(15,"div",2),o.Wb(16,"span",3),o.Kc(17,"\u603b\u8d44\u4ea7"),o.Vb(),o.Wb(18,"span",4),o.Kc(19),o.Vb(),o.Vb(),o.Wb(20,"div",2),o.Wb(21,"span",3),o.Kc(22,"\u8d26\u6237\u6570"),o.Vb(),o.Wb(23,"span",4),o.Kc(24),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Vb(),o.Wb(25,"nz-card"),o.Wb(26,"form",5,6),o.dc("ngSubmit",function(){return t.search()}),o.Wb(28,"se",7),o.Wb(29,"input",8),o.dc("ngModelChange",function(n){return t.q.name=n}),o.Vb(),o.Vb(),o.Wb(30,"se",7),o.Wb(31,"nz-select",9),o.dc("ngModelChange",function(n){return t.q.type=n}),o.Ic(32,L,3,4,"nz-option",10),o.Vb(),o.Vb(),o.Wb(33,"se",7),o.Wb(34,"nz-select",11),o.dc("ngModelChange",function(n){return t.q.status=n}),o.Ic(35,I,1,2,"nz-option",12),o.Vb(),o.Vb(),o.Wb(36,"se",7),o.Wb(37,"nz-select",13),o.dc("ngModelChange",function(n){return t.q.sort=n}),o.Ic(38,x,1,2,"nz-option",12),o.Vb(),o.Vb(),o.Wb(39,"button",14),o.Kc(40,"\u67e5\u8be2"),o.Vb(),o.Wb(41,"button",15),o.dc("click",function(){return t.reset()}),o.Kc(42,"\u91cd\u7f6e"),o.Vb(),o.Vb(),o.Wb(43,"button",16),o.dc("click",function(){return t.form()}),o.Rb(44,"i",17),o.Wb(45,"span"),o.Kc(46,"\u65b0\u5efa"),o.Vb(),o.Vb(),o.Vb(),o.Wb(47,"nz-list",18),o.Ic(48,O,10,8,"ng-template",null,19,o.Jc),o.Vb()),2&n){const n=o.xc(49);o.Cb(3),o.oc("nzXs",24)("nzSm",6),o.Cb(4),o.Lc(null==t.overview?null:t.overview.net_asset),o.Cb(2),o.oc("nzXs",24)("nzSm",6),o.Cb(4),o.Lc(null==t.overview?null:t.overview.liabilities),o.Cb(2),o.oc("nzXs",24)("nzSm",6),o.Cb(4),o.Lc(null==t.overview?null:t.overview.total_assets),o.Cb(1),o.oc("nzXs",24)("nzSm",6),o.Cb(4),o.Lc(null==t.overview?null:t.overview.count),o.Cb(2),o.oc("labelWidth",null),o.Cb(3),o.oc("ngModel",t.q.name),o.Cb(2),o.oc("ngModel",t.q.type)("nzPlaceHolder","\u5168\u90e8\u7c7b\u578b"),o.Cb(1),o.oc("ngForOf",t.accountTypes),o.Cb(2),o.oc("ngModel",t.q.status)("nzPlaceHolder","\u72b6\u6001"),o.Cb(1),o.oc("ngForOf",t.accountStatus),o.Cb(2),o.oc("ngModel",t.q.sort)("nzPlaceHolder","\u9ed8\u8ba4\u6392\u5e8f"),o.Cb(1),o.oc("ngForOf",t.accountSorts),o.Cb(1),o.oc("nzType","primary")("nzLoading",t.loading),o.Cb(4),o.oc("nzType","primary"),o.Cb(4),o.oc("nzDataSource",t.list)("nzLoading",t.loading)("nzRenderItem",n)("nzGrid",o.rc(30,M))}},directives:[l.a,r.c,r.a,u.u,u.n,u.o,d.b,p.b,p.a,g.b,u.d,u.m,u.p,h.e,z.n,m.a,f.a,v.a,V.a,C.a,C.b,h.a,W.a,i.m,y.a,w.b,w.a,T.a],pipes:[s.c],styles:[""],changeDetection:0}),n})();var $=e("XNiG"),_=e("oyxB"),F=e("Ybvb"),P=e("3um6");function X(n,t){1&n&&(o.Wb(0,"button",10),o.Rb(1,"i",11),o.Vb(),o.Wb(2,"span",12),o.Kc(3,"\u8d26\u53f7\u8be6\u60c5"),o.Vb())}function B(n,t){if(1&n&&(o.Wb(0,"div",13),o.Rb(1,"i",14),o.Wb(2,"sv-container",15),o.Wb(3,"sv",16),o.Kc(4),o.Vb(),o.Wb(5,"sv",17),o.Kc(6),o.Vb(),o.Wb(7,"sv",18),o.Kc(8),o.Vb(),o.Wb(9,"sv",19),o.Kc(10),o.Vb(),o.Rb(11,"sv",20),o.Vb(),o.Vb()),2&n){const n=o.gc();o.Cb(1),o.qc("nzIconfont","icon-",n.account.type,""),o.Cb(3),o.Lc(n.account.name),o.Cb(2),o.Lc(n.account.type_name),o.Cb(2),o.Nc("",n.account.currency_code," ",n.account.currency_balance,""),o.Cb(2),o.Lc(n.account.status_txt)}}function Q(n,t){if(1&n){const n=o.Xb();o.Wb(0,"button",21),o.dc("click",function(){o.Ac(n);const t=o.gc();return t.form(t.account)}),o.Kc(1,"\u7f16\u8f91"),o.Vb(),o.Wb(2,"button",22),o.dc("nzOnConfirm",function(){o.Ac(n);const t=o.gc();return t.delete(t.account)}),o.Kc(3," \u5220\u9664 "),o.Vb()}}function j(n,t){if(1&n&&o.Rb(0,"div",24),2&n){const n=o.gc(2);o.oc("options",n.accountBalancesTrend)}}function D(n,t){if(1&n&&(o.Wb(0,"div"),o.Wb(1,"p"),o.Kc(2,"\u6700\u8fd1\u4e00\u4e2a\u6708\u4f59\u989d\u53d8\u5316"),o.Vb(),o.Ic(3,j,1,1,"div",23),o.Vb()),2&n){const n=o.gc();o.Cb(3),o.oc("ngIf",!n.accountBalancesTrendLoading)}}function J(n,t){if(1&n&&(o.Wb(0,"div"),o.Rb(1,"app-record-grid",25),o.Vb()),2&n){const n=o.gc();o.Cb(1),o.oc("q",n.q)("showLedger",!0)("resetSubject",n.resetSubjectValue)}}const H=[{path:"index",component:R},{path:"view/:id",component:(()=>{class n{constructor(n,t,e,c,i,a){this.http=n,this.route=t,this.cdr=e,this.modal=c,this.msg=i,this.router=a,this.url="/api/accounts",this.q={page:1,pageSize:50,expand:"ledger"},this.accountTypes=[],this.loading=!0,this.accountBalancesTrendLoading=!0,this.index=0,this.list=[],this.resetSubjectValue=new $.a}ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),this.q.account_id=this.id,this.getAccount(),this.getAccountTypes(),this.getAccountBalancesTrend()}getAccount(){this.loading=!0,this.http.get(`${this.url}/${this.id}`).subscribe(n=>{this.account=n.data,this.loading=!1,this.cdr.detectChanges()})}form(n={}){this.modal.create(a.a,{record:n,accountTypes:this.accountTypes},{size:"md"}).subscribe(()=>{this.getAccount(),1===this.index&&this.resetSubjectValue.next(this.q),0===this.index&&this.getAccountBalancesTrend(),this.cdr.detectChanges()})}delete(n){this.http.delete(`/api/accounts/${n.id}`).subscribe(n=>{0===(null==n?void 0:n.code)?(this.msg.success("\u5220\u9664\u6210\u529f"),this.router.navigateByUrl("/account/index")):this.msg.warning(null==n?void 0:n.message)})}getAccountTypes(){this.http.get("/api/accounts/types").subscribe(n=>{n.data&&(this.accountTypes=n.data,this.cdr.detectChanges())})}getAccountBalancesTrend(){this.accountBalancesTrendLoading=!0,this.http.get(`${this.url}/${this.id}/balances/trend`).subscribe(n=>{this.accountBalancesTrendLoading=!1,this.accountBalancesTrend={data:n.data,xField:"date",yField:"after_balance",meta:{date:{alias:"\u65e5\u671f"},after_balance:{alias:"\u4f59\u989d"}},interactions:[{type:"slider",cfg:{start:0,end:1}}]},this.cdr.detectChanges()})}}return n.\u0275fac=function(t){return new(t||n)(o.Qb(s.p),o.Qb(i.a),o.Qb(o.h),o.Qb(s.j),o.Qb(b.e),o.Qb(i.k))},n.\u0275cmp=o.Kb({type:n,selectors:[["app-account-view"]],decls:14,vars:7,consts:[[1,"pt-md"],[3,"nzTitle","nzExtra","nzLoading"],["title",""],["nz-row","",4,"ngIf"],["extraTemplate",""],[2,"width","100%"],["nzSize","large",3,"nzSelectedIndex","nzSelectedIndexChange"],["nzTitle","\u4f59\u989d"],["nzTitle","\u8bb0\u5f55"],[4,"ngIf"],["nz-button","","routerLink","/account/index"],["nz-icon","","nzType","arrow-left"],[1,"pl-md"],["nz-row",""],["nz-icon","",1,"icon-md","pr-md",3,"nzIconfont"],["size","small","col","2"],["label","\u540d\u79f0"],["label","\u7c7b\u578b"],["label","\u4f59\u989d"],["label","\u72b6\u6001"],["label","\u5907\u6ce8"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzDanger","","nz-popconfirm","","nzPopconfirmTitle","\u786e\u5b9a\u8981\u5220\u9664\u5e10\u6237\u5417\uff1f\u5982\u679c\u5e10\u6237\u88ab\u5220\u9664\uff0c\u6240\u6709\u6d89\u53ca\u7684\u4ea4\u6613\u3001\u89c4\u5219\u548c\u5b9a\u65f6\u914d\u7f6e\u5c06\u6c38\u8fdc\u5931\u53bb\u3002","nzPopconfirmPlacement","bottom",3,"nzOnConfirm"],["starkG2plotArea","",3,"options",4,"ngIf"],["starkG2plotArea","",3,"options"],[3,"q","showLedger","resetSubject"]],template:function(n,t){if(1&n&&(o.Wb(0,"div",0),o.Wb(1,"nz-card",1),o.Ic(2,X,4,0,"ng-template",null,2,o.Jc),o.Ic(4,B,12,6,"div",3),o.Vb(),o.Ic(5,Q,4,0,"ng-template",null,4,o.Jc),o.Vb(),o.Wb(7,"nz-card",5),o.Wb(8,"nz-card-tab"),o.Wb(9,"nz-tabset",6),o.dc("nzSelectedIndexChange",function(n){return t.index=n}),o.Rb(10,"nz-tab",7),o.Rb(11,"nz-tab",8),o.Vb(),o.Vb(),o.Ic(12,D,4,1,"div",9),o.Ic(13,J,2,3,"div",9),o.Vb()),2&n){const n=o.xc(3),e=o.xc(6);o.Cb(1),o.oc("nzTitle",n)("nzExtra",e)("nzLoading",t.loading),o.Cb(3),o.oc("ngIf",t.account),o.Cb(5),o.oc("nzSelectedIndex",t.index),o.Cb(3),o.oc("ngIf",0===t.index),o.Cb(1),o.oc("ngIf",1===t.index)}},directives:[l.a,z.o,l.d,_.b,_.a,m.a,f.a,v.a,i.l,V.a,r.c,w.b,w.a,y.a,F.a,P.a],encapsulation:2}),n})()}];let G=(()=>{class n{}return n.\u0275mod=o.Ob({type:n}),n.\u0275inj=o.Nb({factory:function(t){return new(t||n)},imports:[[i.n.forChild(H)],i.n]}),n})(),N=(()=>{class n{}return n.\u0275mod=o.Ob({type:n}),n.\u0275inj=o.Nb({factory:function(t){return new(t||n)},imports:[[c.b,G]]}),n})()}}]);