(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{FAb8:function(e,t,n){"use strict";n.r(t),n.d(t,"RecordModule",function(){return O});var c=n("M0ag"),r=n("fXoL"),a=n("PScX"),i=n("Ac7g"),o=(n("3Pt+"),n("ocnv"),n("O3k0"),n("PTRe"),n("OzZK")),s=n("RwU8"),d=n("C2AL"),b=n("/2AU"),l=n("ExrR"),u=n("dEAy"),p=n("luDG"),h=n("Ah5K"),m=n("IvDN"),g=n("rMZv"),z=n("ofXK"),f=n("D9mS"),V=n("FwiY");function W(e,t){if(1&e&&(r.Wb(0,"tr"),r.Wb(1,"td"),r.Lc(2),r.Vb(),r.Wb(3,"td"),r.Lc(4),r.Vb(),r.Wb(5,"td"),r.Lc(6),r.Vb(),r.Vb()),2&e){const e=t.$implicit;r.Cb(2),r.Mc(e.column_name),r.Cb(2),r.Mc(e.description),r.Cb(2),r.Mc(e.required)}}let v=(()=>{class e{constructor(e,t,n,c){this.modal=e,this.msgSrv=t,this.http=n,this.cache=c,this.dataSet=[{column_name:"\u8d26\u5355\u65e5\u671f",description:"\u6d88\u8d39\u65f6\u95f4, \u5e38\u89c1\u7684\u65f6\u95f4\u683c\u5f0f\u90fd\u652f\u6301\uff0c\u5982\uff1a\u300c2020-09-08 20:35\u300d \u300c2020-09-08\u300d",required:"\u662f"},{column_name:"\u7c7b\u522b",description:"\u8d26\u5355\u7c7b\u522b\uff0c\u5fc5\u987b\u5df2\u7ecf\u5b58\u5728\u7684\u5206\u7c7b",required:"\u662f"},{column_name:"\u7c7b\u578b",description:"\u8d26\u5355\u7c7b\u578b\uff0c\u76ee\u524d\u53ea\u6709\u300c\u652f\u51fa\u300d\u3001\u300c\u6536\u5165\u300d\u3001\u300c\u8f6c\u8d26\u300d",required:"\u662f"},{column_name:"\u91d1\u989d",description:"\u6d88\u8d39\u91d1\u989d\uff0c\u6574\u6570\u6216\u8005\u6700\u591a\u4e24\u4f4d\u5c0f\u6570",required:"\u662f"},{column_name:"\u6807\u7b7e",description:"\u591a\u4e2a\u6807\u7b7e\u7528\u300c/\u300d\u5206\u5f00",required:"\u5426"},{column_name:"\u63cf\u8ff0",description:"\u8d26\u5355\u63cf\u8ff0",required:"\u5426"},{column_name:"\u5907\u6ce8",description:"\u8d26\u5355\u5907\u6ce8",required:"\u5426"},{column_name:"\u8d26\u62371",description:"\u6536\u5165\u6216\u8005\u652f\u51fa\u7684\u8d26\u6237\uff0c\u6216\u8005\u662f\u8f6c\u8d26\u7c7b\u578b\u7684\u8f6c\u51fa\u8d26\u6237\u3002\u5982\u679c\u4e3a\u7a7a\uff0c\u5219\u4f7f\u7528\u9ed8\u8ba4\u8d26\u6237\uff0c\u5426\u5219\u586b\u5199\u7684\u8d26\u6237\u5fc5\u987b\u5df2\u5b58\u5728",required:"\u5426"},{column_name:"\u8d26\u62372",description:"\u8f6c\u8d26\u7c7b\u578b\u65f6\u7684\u8f6c\u5165\u8d26\u6237",required:"\u4ea4\u6613\u7c7b\u578b\u4e3a\u300c\u8f6c\u8d26\u300d\u65f6\u5fc5\u586b"}];const r=c.getNone(l.a.cacheKey.defaultIdLedger);this.url=`/api/transactions/upload?ledger_id=${r}`}handleChange({file:e}){const t=e.status;if("done"===t)if(0===e.response.code)if(0===e.response.data.fail)this.msgSrv.success(`${e.name} \u5bfc\u5165\u6210\u529f`);else{const t=e.response.data.fail_list[0];this.msgSrv.error(`${e.name} \u5bfc\u5165\u5931\u8d25\uff1a[${t.data.toString()}] ${t.reason}`)}else this.msgSrv.error(`${e.name} \u5bfc\u5165\u5931\u8d25\uff1a${e.response.message}`);else"error"===t&&this.msgSrv.error(`${e.name} \u6587\u4ef6\u4e0a\u4f20\u5931\u8d25`)}close(){this.modal.destroy()}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(u.b),r.Qb(a.e),r.Qb(i.p),r.Qb(p.a))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-record-import"]],decls:27,vars:5,consts:[[1,"modal-header"],[1,"modal-title"],["down-file","","http-url","./assets/import-template.csv","file-name","CashWarden\u5bfc\u5165\u6a21\u7248.csv"],["nzHeader","\u5bfc\u5165\u6a21\u7248\u8bf4\u660e",3,"nzActive"],["nzSize","small",3,"nzData","nzShowPagination"],["basicTable",""],[4,"ngFor","ngForOf"],["nzType","drag","nzAccept",".csv",3,"nzAction","nzChange"],[1,"ant-upload-drag-icon"],["nz-icon","","nzType","inbox"],[1,"ant-upload-text"],[1,"ant-upload-hint"]],template:function(e,t){if(1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Lc(2,"\u5bfc\u5165 CSV \u6587\u4ef6"),r.Vb(),r.Vb(),r.Wb(3,"p"),r.Wb(4,"a",2),r.Lc(5," \u4e0b\u8f7d\u6a21\u7248\u6587\u4ef6 "),r.Vb(),r.Vb(),r.Wb(6,"nz-collapse"),r.Wb(7,"nz-collapse-panel",3),r.Wb(8,"nz-table",4,5),r.Wb(10,"thead"),r.Wb(11,"tr"),r.Wb(12,"th"),r.Lc(13,"\u5217\u540d"),r.Vb(),r.Wb(14,"th"),r.Lc(15,"\u63cf\u8ff0"),r.Vb(),r.Wb(16,"th"),r.Lc(17,"\u662f\u5426\u5fc5\u987b"),r.Vb(),r.Vb(),r.Vb(),r.Wb(18,"tbody"),r.Jc(19,W,7,3,"tr",6),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(20,"nz-upload",7),r.dc("nzChange",function(e){return t.handleChange(e)}),r.Wb(21,"p",8),r.Rb(22,"i",9),r.Vb(),r.Wb(23,"p",10),r.Lc(24,"\u70b9\u51fb\u6216\u62d6\u52a8\u6587\u4ef6\u5230\u6b64\u533a\u57df\u4e0a\u4f20"),r.Vb(),r.Wb(25,"p",11),r.Lc(26,"\u652f\u6301\u591a\u6b21\u4e0a\u4f20\uff0c\u6bcf\u6b21\u4e0a\u4f20\u7684\u6587\u4ef6\u8981\u4e48\u5168\u90e8\u5931\u8d25\uff0c\u8981\u4e48\u5168\u90e8\u6210\u529f\u5bfc\u5165\u6570\u636e\u3002"),r.Vb(),r.Vb()),2&e){const e=r.yc(9);r.Cb(7),r.oc("nzActive",!1),r.Cb(1),r.oc("nzData",t.dataSet)("nzShowPagination",!1),r.Cb(11),r.oc("ngForOf",e.data),r.Cb(1),r.oc("nzAction",t.url)}},directives:[h.a,m.a,m.c,g.c,g.k,g.l,g.b,g.j,g.g,z.n,f.a,d.a,V.a],encapsulation:2}),e})();var q=n("sWYD"),C=n("XNiG"),y=n("updA"),S=n("JA5x"),w=n("B+r4"),_=n("nJia"),x=n("9H8w"),L=n("3um6");const A=function(){return{xs:6,sm:16,md:24,lg:32}};let j=(()=>{class e{constructor(e,t,n,c,r){this.http=e,this.modal=t,this.cdr=n,this.xlsx=c,this.cache=r,this.resetSubjectValue=new C.a,this.q={page:1,pageSize:50},this.list=[],this.loading=!0}ngOnInit(){this.q.ledger_id=this.cache.getNone(l.a.cacheKey.defaultIdLedger)}import(){this.modal.create(v,{},{size:"lg"}).subscribe(()=>{this.q.page=1,this.resetSubjectValue.next(this.q),this.cdr.detectChanges()})}form(e={}){this.modal.create(b.a,{record:e.transaction},{size:"md"}).subscribe(()=>{this.q.page=1,this.resetSubjectValue.next(this.q),this.cdr.detectChanges()})}download(){const e=[["\u8d26\u5355\u65e5\u671f","\u7c7b\u522b","\u7c7b\u578b","\u91d1\u989d","\u6807\u7b7e","\u63cf\u8ff0","\u5907\u6ce8","\u8d26\u6237 1","\u8d26\u6237 2"]];this.http.get("/api/transactions/export",{ledger_id:this.q.ledger_id}).subscribe(t=>{const n=e.concat(t.data),c=Object(q.a)(new Date,"yyyy-MM-dd");this.xlsx.export({sheets:[{data:n,name:"sheet name"}],opts:{bookType:"csv"},filename:`CashWarden_Export_${c}.csv`})})}reloadData(e){e&&(this.q.page=1,this.q.ledger_id=this.cache.getNone(l.a.cacheKey.defaultIdLedger),this.q=e,this.resetSubjectValue.next(this.q))}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(i.p),r.Qb(i.j),r.Qb(r.h),r.Qb(y.b),r.Qb(p.a))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-record-index"]],decls:17,vars:8,consts:[[1,"pt-lg"],[3,"nzBordered"],["nz-row","",3,"nzGutter"],["nz-col",""],["nz-button","",3,"nzType","click"],["nz-icon","","nzType","plus"],["nz-col","",1,"text-right"],["nz-button","",3,"click"],["nz-button","","nz-tooltip","","nzTooltipTitle","\u5bfc\u51fa\u6682\u4e0d\u5305\u62ec\u300c\u4f59\u989d\u8c03\u6574\u300d\u7c7b\u578b\u8bb0\u5f55",3,"click"],[3,"q","searched","reseted"],[3,"q","resetSubject"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"nz-card",1),r.Wb(2,"div",2),r.Wb(3,"div",3),r.Wb(4,"button",4),r.dc("click",function(){return t.form()}),r.Rb(5,"i",5),r.Wb(6,"span"),r.Lc(7,"\u7ecf\u5178\u8bb0\u8d26"),r.Vb(),r.Vb(),r.Vb(),r.Wb(8,"div",6),r.Wb(9,"nz-button-group"),r.Wb(10,"button",7),r.dc("click",function(){return t.import()}),r.Lc(11,"\u5bfc\u5165"),r.Vb(),r.Wb(12,"button",8),r.dc("click",function(){return t.download()}),r.Lc(13,"\u5bfc\u51fa"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(14,"app-record-search",9),r.dc("searched",function(e){return t.reloadData(e)})("reseted",function(e){return t.reloadData(e)}),r.Vb(),r.Wb(15,"nz-card",1),r.Rb(16,"app-record-grid",10),r.Vb()),2&e&&(r.Cb(1),r.oc("nzBordered",!1),r.Cb(1),r.oc("nzGutter",r.rc(7,A)),r.Cb(2),r.oc("nzType","default"),r.Cb(10),r.oc("q",t.q),r.Cb(1),r.oc("nzBordered",!1),r.Cb(1),r.oc("q",t.q)("resetSubject",t.resetSubjectValue))},directives:[S.a,w.c,w.a,o.a,s.a,d.a,V.a,o.b,_.d,x.a,L.a],styles:["[_nghost-%COMP%]     .select-icon{padding-right:4px}[_nghost-%COMP%]     .float-right{float:right}"]}),e})();var k=n("tyNb");const D=[{path:"index",component:j}];let M=(()=>{class e{}return e.\u0275mod=r.Ob({type:e}),e.\u0275inj=r.Nb({factory:function(t){return new(t||e)},imports:[[k.n.forChild(D)],k.n]}),e})(),O=(()=>{class e{}return e.\u0275mod=r.Ob({type:e}),e.\u0275inj=r.Nb({factory:function(t){return new(t||e)},imports:[[c.b,M]]}),e})()}}]);