{"version":3,"sources":["./src/app/routes/tag/tag-routing.module.ts","./src/app/routes/tag/index/index.component.ts","./src/app/routes/tag/index/index.component.html","./src/app/routes/tag/form/form.component.ts","./src/app/routes/tag/form/form.component.html","./src/app/routes/tag/tag.module.ts"],"names":[],"mappings":"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","file":"tag-tag-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { TagIndexComponent } from './index/index.component';\n\nconst routes: Routes = [{ path: 'index', component: TagIndexComponent }];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class TagRoutingModule {}\n","import { ChangeDetectorRef, Component, OnInit, ViewChild } from '@angular/core';\nimport { STColumn, STComponent } from '@delon/abc/st';\nimport { CacheService } from '@delon/cache';\nimport { SFSchema, SFSelectWidgetSchema } from '@delon/form';\nimport { ModalHelper, _HttpClient } from '@delon/theme';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { params } from 'src/app/shared/params';\nimport { TagFormComponent } from '../form/form.component';\n\n@Component({\n  selector: 'app-tag-index',\n  templateUrl: './index.component.html',\n})\nexport class TagIndexComponent implements OnInit {\n  @ViewChild('st', { static: false }) st: STComponent;\n\n  loading = true;\n  pagination: {};\n  list: any[] = [];\n  q = {\n    page: 1,\n    pageSize: 100,\n    name: '',\n    ledger_id: 0,\n  };\n\n  searchSchema: SFSchema = {\n    properties: {\n      name: {\n        type: 'string',\n        title: '名称',\n      },\n    },\n  };\n  columns: STColumn[] = [\n    { title: '名称', index: 'name' },\n    { title: '次数', index: 'count' },\n    { title: '时间', type: 'date', index: 'updated_at' },\n    {\n      title: '',\n      buttons: [\n        {\n          icon: 'edit',\n          click: (item: any) => this.form(item),\n        },\n        {\n          icon: 'delete',\n          type: 'del',\n          pop: {\n            title: '确定要删除吗？',\n            okType: 'danger',\n          },\n          click: (record, _modal, comp) => {\n            this.delete(record, comp);\n          },\n        },\n      ],\n    },\n  ];\n\n  constructor(private http: _HttpClient, private modal: ModalHelper, private cache: CacheService, private msg: NzMessageService) {\n  }\n\n  ngOnInit() {\n    this.getData();\n  }\n\n  getData(): void {\n    this.loading = true;\n    this.q.ledger_id = this.cache.getNone(params.cacheKey.defaultIdLedger);\n    this.http.get('/api/tags', this.q).subscribe((res) => {\n      this.list = res.data.items;\n      this.pagination = res.data._meta;\n      this.loading = false;\n    });\n  }\n\n  form(record: { id?: number } = {}): void {\n    this.modal.create(TagFormComponent, { record }, { size: 'md' }).subscribe((res) => {\n      if (record.id) {\n        // record = res;\n        this.getData();\n      } else {\n        this.list.splice(0, 0, res);\n        this.list = [...this.list];\n      }\n    });\n  }\n\n  delete(record: any, comp): void {\n    this.http.delete(`/api/tags/${record.id}`).subscribe((res) => {\n      if (res?.code !== 0) {\n        this.msg.warning(res?.message);\n        return;\n      }\n      // tslint:disable-next-line: no-non-null-assertion\n      comp!.removeRow(record);\n      // this.getData();\n      this.msg.success('删除成功');\n    });\n  }\n\n  submit(value: any): void {\n    if (value.name) {\n      this.q.name = value.name;\n      this.getData();\n    }\n  }\n}\n","<div class=\"pt-lg\">\n  <nz-card>\n    <div nz-row [nzGutter]=\"{ xs: 6, sm: 16, md: 24, lg: 32 }\">\n      <div nz-col>\n        <sf mode=\"search\" [schema]=\"searchSchema\" (formSubmit)=\"submit($event)\" (formReset)=\"st.reset($event)\"></sf>\n      </div>\n      <div nz-col>\n        <button (click)=\"form()\" nz-button nzType=\"primary\">新建</button>\n      </div>\n    </div>\n  </nz-card>\n</div>\n\n<nz-card>\n  <st #st [data]=\"list\" [columns]=\"columns\"></st>\n</nz-card>\n","import { Component, OnInit, ViewChild } from '@angular/core';\nimport { CacheService } from '@delon/cache';\nimport { SFComponent, SFSchema, SFUISchema } from '@delon/form';\nimport { _HttpClient } from '@delon/theme';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport { NzModalRef } from 'ng-zorro-antd/modal';\nimport { params } from 'src/app/shared/params';\n\n@Component({\n  selector: 'app-tag-form',\n  templateUrl: './form.component.html',\n})\nexport class TagFormComponent implements OnInit {\n  @ViewChild('sf', { static: false }) private sf: SFComponent;\n  record: any = {};\n  ledger_id = 0;\n  schema: SFSchema = {\n    properties: {\n      name: { type: 'string', title: '名称' },\n    },\n    required: ['name'],\n  };\n  ui: SFUISchema = {\n    '*': {\n      spanLabelFixed: 100,\n      grid: { span: 24 },\n    },\n  };\n\n  constructor(private modal: NzModalRef, private msgSrv: NzMessageService, public http: _HttpClient, private cache: CacheService) {}\n\n  ngOnInit(): void {\n    this.ledger_id = this.cache.getNone(params.cacheKey.defaultIdLedger);\n  }\n\n  save(value: any) {\n    const url = this.record.id ? `/${this.record.id}` : '';\n    const method = this.record.id ? 'put' : 'post';\n    value.ledger_id = this.ledger_id;\n    this.http.request(method, `/api/tags${url}`, { body: value }).subscribe((res: any) => {\n      if (res.code !== 0) {\n        this.msgSrv.warning(res.message);\n        return;\n      }\n      this.msgSrv.success('保存成功');\n      this.modal.close(res.data);\n    });\n  }\n\n  close() {\n    this.modal.destroy();\n  }\n}\n","<div class=\"modal-header\">\n  <div class=\"modal-title\">编辑标签</div>\n</div>\n<sf #sf mode=\"edit\" [schema]=\"schema\" [ui]=\"ui\" [formData]=\"record\" button=\"none\">\n  <div class=\"modal-footer\">\n    <button nz-button type=\"button\" (click)=\"close()\">关闭</button>\n    <button nz-button type=\"submit\" nzType=\"primary\" (click)=\"save(sf.value)\" [disabled]=\"!sf.valid\" [nzLoading]=\"http.loading\">\n      保存\n    </button>\n  </div>\n</sf>\n","import { NgModule } from '@angular/core';\nimport { SharedModule } from '@shared';\nimport { TagRoutingModule } from './tag-routing.module';\nimport { TagFormComponent } from './form/form.component';\nimport { TagIndexComponent } from './index/index.component';\n\nconst COMPONENTS = [TagIndexComponent];\nconst COMPONENTS_NOROUNT = [TagFormComponent];\n\n@NgModule({\n  imports: [SharedModule, TagRoutingModule],\n  declarations: [...COMPONENTS, ...COMPONENTS_NOROUNT],\n})\nexport class TagModule {}\n"],"sourceRoot":"webpack:///"}