(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{mKul:function(e,t,n){"use strict";n.r(t),n.d(t,"CurrencyModule",function(){return S});var c=n("M0ag"),i=n("tyNb"),o=n("ExrR"),r=n("fXoL"),s=n("dEAy"),d=n("PScX"),a=n("Ac7g"),l=n("luDG"),u=n("ofXK"),b=n("3Pt+"),h=n("ocnv"),g=n("O3k0"),m=n("PTRe"),f=n("zAKX"),p=n("OzZK"),y=n("RwU8"),_=n("C2AL"),z=n("qAZ0");function C(e,t){1&e&&(r.Wb(0,"div",14),r.Lc(1,"\u7f16\u8f91\u8d27\u5e01"),r.Vb())}function v(e,t){1&e&&(r.Wb(0,"div",14),r.Lc(1,"\u6dfb\u52a0\u8d27\u5e01"),r.Vb())}function V(e,t){if(1&e&&(r.Wb(0,"nz-option",15),r.Lc(1),r.Vb()),2&e){const e=t.$implicit;r.oc("nzLabel",e.name)("nzValue",e.code),r.Cb(1),r.Nc(" ",e.name," ")}}function W(e,t){1&e&&r.Rb(0,"nz-spin",16)}function w(e,t){if(1&e&&r.Lc(0),2&e){const e=r.gc(2);r.Nc("1",e.form.currency_code_from,"=")}}function L(e,t){if(1&e){const e=r.Xb();r.Wb(0,"se",17),r.Wb(1,"nz-input-group",18),r.Wb(2,"input",19),r.dc("ngModelChange",function(t){return r.Bc(e),r.gc().form.rate=t}),r.Vb(),r.Vb(),r.Jc(3,w,1,1,"ng-template",null,20,r.Kc),r.Vb()}if(2&e){const e=r.yc(4),t=r.gc();r.Cb(1),r.oc("nzAddOnBefore",e)("nzAddOnAfter",t.form.currency_code_to),r.Cb(1),r.oc("ngModel",t.form.rate)}}let M=(()=>{class e{constructor(e,t,n,c,i){this.modal=e,this.msgSrv=t,this.http=n,this.cdr=c,this.cache=i,this.record={},this.ledger_id=0,this.form={ledger_id:0,currency_code_from:"",currency_code_to:"",rate:0},this.loading=!1}ngOnInit(){this.record.id&&(this.form=this.record),this.ledger_id=this.cache.getNone(o.a.cacheKey.defaultIdLedger),this.form.currency_code_to=this.base_currency_code}save(e){const t=this.record.id?`/${this.record.id}`:"",n=this.record.id?"put":"post";e.ledger_id=this.ledger_id,this.http.request(n,`/api/currencies${t}`,{body:e}).subscribe(e=>{0===e.code?(this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(e.data)):this.msgSrv.warning(e.message)})}changeCurrency(e){this.loading=!0,this.http.get(`/api/currencies/rate/${e}/${this.form.currency_code_to}`).subscribe(e=>{0===e.code?(this.form.rate=e.data.rate,this.loading=!1,this.cdr.detectChanges()):this.msgSrv.warning(e.message)})}close(){this.modal.destroy()}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(s.b),r.Qb(d.e),r.Qb(a.p),r.Qb(r.h),r.Qb(l.a))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-currency-form"]],decls:17,vars:8,consts:[[1,"modal-header"],["class","modal-title",4,"ngIf"],["nz-form","","se-container","1","labelWidth","100",3,"ngSubmit"],["f","ngForm"],["label","\u57fa\u7840\u8d27\u5e01"],["type","text","nz-input","","name","currency_code_to","disabled","",3,"ngModel","ngModelChange"],["label","\u8d27\u5e01\u540d\u79f0"],["name","currency_code_from","required","",3,"ngModel","ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzSimple","","style","padding-top: 1rem",4,"ngIf"],["label","\u6c47\u7387","optionalHelp","\u9ed8\u8ba4\u81ea\u52a8\u83b7\u53d6\u6700\u65b0\u6c47\u7387\uff0c\u53ef\u4fee\u6539",4,"ngIf"],["col","1"],["nz-button","","nzType","primary",3,"disabled"],["nz-button","","type","button",3,"click"],[1,"modal-title"],["nzCustomContent","",3,"nzLabel","nzValue"],["nzSimple","",2,"padding-top","1rem"],["label","\u6c47\u7387","optionalHelp","\u9ed8\u8ba4\u81ea\u52a8\u83b7\u53d6\u6700\u65b0\u6c47\u7387\uff0c\u53ef\u4fee\u6539"],[3,"nzAddOnBefore","nzAddOnAfter"],["type","number","nz-input","","name","rate","required","",3,"ngModel","ngModelChange"],["addOnBefore",""]],template:function(e,t){if(1&e&&(r.Wb(0,"div",0),r.Jc(1,C,2,0,"div",1),r.Jc(2,v,2,0,"div",1),r.Vb(),r.Wb(3,"form",2,3),r.dc("ngSubmit",function(){return t.save(t.form)}),r.Wb(5,"se",4),r.Wb(6,"input",5),r.dc("ngModelChange",function(e){return t.form.currency_code_to=e}),r.Vb(),r.Vb(),r.Wb(7,"se",6),r.Wb(8,"nz-select",7),r.dc("ngModelChange",function(e){return t.form.currency_code_from=e})("ngModelChange",function(e){return t.changeCurrency(e)}),r.Jc(9,V,2,3,"nz-option",8),r.Vb(),r.Jc(10,W,1,0,"nz-spin",9),r.Vb(),r.Jc(11,L,5,3,"se",10),r.Wb(12,"se",11),r.Wb(13,"button",12),r.Lc(14,"\u4fdd\u5b58"),r.Vb(),r.Wb(15,"button",13),r.dc("click",function(){return t.close()}),r.Lc(16,"\u5173\u95ed"),r.Vb(),r.Vb(),r.Vb()),2&e){const e=r.yc(4);r.Cb(1),r.oc("ngIf",t.record.id),r.Cb(1),r.oc("ngIf",!t.record.id),r.Cb(4),r.oc("ngModel",t.form.currency_code_to),r.Cb(2),r.oc("ngModel",t.form.currency_code_from),r.Cb(1),r.oc("ngForOf",t.codes),r.Cb(1),r.oc("ngIf",t.loading),r.Cb(1),r.oc("ngIf",t.form.currency_code_from&&!t.loading),r.Cb(2),r.oc("disabled",e.invalid)}},directives:[u.o,b.u,b.n,b.o,h.b,g.b,g.a,m.b,b.d,b.m,b.p,f.e,b.s,u.n,p.a,y.a,_.a,f.a,z.a,m.c,b.q],encapsulation:2}),e})();var O=n("JA5x"),A=n("B+r4"),Q=n("DGaY");const I=["st"];function k(e,t){if(1&e&&r.Lc(0),2&e){const e=t.$implicit;r.Pc(" 1 ",e.currency_code_from," = ",e.rate," ",e.currency_code_to," ")}}const x=function(){return{xs:6,sm:16,md:24,lg:32}},J=[{path:"index",component:(()=>{class e{constructor(e,t,n,c,i){this.http=e,this.modal=t,this.cache=n,this.msg=c,this.cdr=i,this.loading=!0,this.list=[],this.q={page:1,pageSize:100,name:"",ledger_id:0},this.columns=[{title:"\u8d27\u5e01",index:"currency_code_from"},{title:"\u6c47\u7387",index:"rate"},{title:"\u63cf\u8ff0",render:"custom"},{title:"\u65f6\u95f4",type:"date",index:"updated_at"},{title:"",buttons:[{icon:"edit",click:e=>this.form(e)},{icon:"delete",type:"del",pop:{title:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",okType:"danger"},click:(e,t,n)=>{this.delete(e,n)}}]}]}ngOnInit(){this.getData(),this.loadCodes(),this.ledger=this.cache.getNone(o.a.cacheKey.defaultLedger),this.base_currency_code=this.ledger.base_currency_code}getData(){this.loading=!0,this.q.ledger_id=this.cache.getNone(o.a.cacheKey.defaultIdLedger),this.http.get("/api/currencies",this.q).subscribe(e=>{this.list=e.data.items,this.pagination=e.data._meta,this.loading=!1})}form(e={}){this.modal.create(M,{record:e,codes:this.codes,base_currency_code:this.base_currency_code},{size:"md"}).subscribe(t=>{e.id?this.getData():(this.list.splice(0,0,t),this.list=[...this.list])})}delete(e,t){this.http.delete(`/api/currencies/${e.id}`).subscribe(n=>{0===(null==n?void 0:n.code)?(t.removeRow(e),this.msg.success("\u5220\u9664\u6210\u529f")):this.msg.warning(null==n?void 0:n.message)})}loadCodes(){this.http.get("/api/currencies/codes").subscribe(e=>{0===e.code?(this.codes=e.data.filter(e=>e.code!==this.base_currency_code),this.cdr.detectChanges()):this.msg.warning(e.message)})}submit(e){e.name&&(this.q.name=e.name,this.getData())}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(a.p),r.Qb(a.j),r.Qb(l.a),r.Qb(d.e),r.Qb(r.h))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-currency-index"]],viewQuery:function(e,t){if(1&e&&r.Qc(I,1),2&e){let e;r.xc(e=r.ec())&&(t.st=e.first)}},decls:10,vars:4,consts:[[1,"pt-lg"],["nz-row","",3,"nzGutter"],["nz-col",""],["nz-button","","nzType","primary",3,"click"],[3,"data","columns"],["st",""],["st-row","custom"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"nz-card"),r.Wb(2,"div",1),r.Wb(3,"div",2),r.Wb(4,"button",3),r.dc("click",function(){return t.form()}),r.Lc(5,"\u65b0\u5efa"),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Vb(),r.Wb(6,"nz-card"),r.Wb(7,"st",4,5),r.Jc(9,k,1,3,"ng-template",6),r.Vb(),r.Vb()),2&e&&(r.Cb(2),r.oc("nzGutter",r.rc(3,x)),r.Cb(5),r.oc("data",t.list)("columns",t.columns))},directives:[O.a,A.c,A.a,p.a,y.a,_.a,Q.a,Q.c],encapsulation:2}),e})()}];let K=(()=>{class e{}return e.\u0275mod=r.Ob({type:e}),e.\u0275inj=r.Nb({factory:function(t){return new(t||e)},imports:[[i.n.forChild(J)],i.n]}),e})(),S=(()=>{class e{}return e.\u0275mod=r.Ob({type:e}),e.\u0275inj=r.Nb({factory:function(t){return new(t||e)},imports:[[c.b,K]]}),e})()}}]);