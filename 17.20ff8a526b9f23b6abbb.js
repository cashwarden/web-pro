(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{pIk6:function(t,e,i){"use strict";i.r(e),i.d(e,"TagModule",function(){return k});var s=i("M0ag"),c=i("tyNb"),n=i("ExrR"),a=i("fXoL"),o=i("dEAy"),r=i("PScX"),d=i("Ac7g"),l=i("luDG"),b=i("ok2U"),u=i("OzZK"),h=i("RwU8"),m=i("C2AL");const p=["sf"];let g=(()=>{class t{constructor(t,e,i,s){this.modal=t,this.msgSrv=e,this.http=i,this.cache=s,this.record={},this.ledger_id=0,this.schema={properties:{name:{type:"string",title:"\u540d\u79f0"}},required:["name"]},this.ui={"*":{spanLabelFixed:100,grid:{span:24}}}}ngOnInit(){this.ledger_id=this.cache.getNone(n.a.cacheKey.defaultIdLedger)}save(t){const e=this.record.id?`/${this.record.id}`:"",i=this.record.id?"put":"post";t.ledger_id=this.ledger_id,this.http.request(i,`/api/tags${e}`,{body:t}).subscribe(t=>{0===t.code?(this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(t.data)):this.msgSrv.warning(t.message)})}close(){this.modal.destroy()}}return t.\u0275fac=function(e){return new(e||t)(a.Qb(o.b),a.Qb(r.e),a.Qb(d.p),a.Qb(l.a))},t.\u0275cmp=a.Kb({type:t,selectors:[["app-tag-form"]],viewQuery:function(t,e){if(1&t&&a.Pc(p,1),2&t){let t;a.wc(t=a.ec())&&(e.sf=t.first)}},decls:10,vars:5,consts:[[1,"modal-header"],[1,"modal-title"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,e){if(1&t){const t=a.Xb();a.Wb(0,"div",0),a.Wb(1,"div",1),a.Kc(2,"\u7f16\u8f91\u6807\u7b7e"),a.Vb(),a.Vb(),a.Wb(3,"sf",2,3),a.Wb(5,"div",4),a.Wb(6,"button",5),a.dc("click",function(){return e.close()}),a.Kc(7,"\u5173\u95ed"),a.Vb(),a.Wb(8,"button",6),a.dc("click",function(){a.Ac(t);const i=a.xc(4);return e.save(i.value)}),a.Kc(9," \u4fdd\u5b58 "),a.Vb(),a.Vb(),a.Vb()}if(2&t){const t=a.xc(4);a.Cb(3),a.oc("schema",e.schema)("ui",e.ui)("formData",e.record),a.Cb(5),a.oc("disabled",!t.valid)("nzLoading",e.http.loading)}},directives:[b.b,u.a,h.a,m.a],encapsulation:2}),t})();var f=i("JA5x"),v=i("B+r4"),y=i("DGaY");const w=["st"],z=function(){return{xs:6,sm:16,md:24,lg:32}},V=[{path:"index",component:(()=>{class t{constructor(t,e,i,s){this.http=t,this.modal=e,this.cache=i,this.msg=s,this.loading=!0,this.list=[],this.q={page:1,pageSize:100,name:"",ledger_id:0},this.searchSchema={properties:{name:{type:"string",title:"\u540d\u79f0"}}},this.columns=[{title:"\u540d\u79f0",index:"name"},{title:"\u6b21\u6570",index:"count"},{title:"\u65f6\u95f4",type:"date",index:"updated_at"},{title:"",buttons:[{icon:"edit",click:t=>this.form(t)},{icon:"delete",type:"del",pop:{title:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",okType:"danger"},click:(t,e,i)=>{this.delete(t,i)}}]}]}ngOnInit(){this.getData()}getData(){this.loading=!0,this.q.ledger_id=this.cache.getNone(n.a.cacheKey.defaultIdLedger),this.http.get("/api/tags",this.q).subscribe(t=>{this.list=t.data.items,this.pagination=t.data._meta,this.loading=!1})}form(t={}){this.modal.create(g,{record:t},{size:"md"}).subscribe(e=>{t.id?this.getData():(this.list.splice(0,0,e),this.list=[...this.list])})}delete(t,e){this.http.delete(`/api/tags/${t.id}`).subscribe(i=>{0===(null==i?void 0:i.code)?(e.removeRow(t),this.msg.success("\u5220\u9664\u6210\u529f")):this.msg.warning(null==i?void 0:i.message)})}submit(t){t.name&&(this.q.name=t.name,this.getData())}}return t.\u0275fac=function(e){return new(e||t)(a.Qb(d.p),a.Qb(d.j),a.Qb(l.a),a.Qb(r.e))},t.\u0275cmp=a.Kb({type:t,selectors:[["app-tag-index"]],viewQuery:function(t,e){if(1&t&&a.Pc(w,1),2&t){let t;a.wc(t=a.ec())&&(e.st=t.first)}},decls:11,vars:5,consts:[[1,"pt-lg"],["nz-row","",3,"nzGutter"],["nz-col",""],["mode","search",3,"schema","formSubmit","formReset"],["nz-button","","nzType","primary",3,"click"],[3,"data","columns"],["st",""]],template:function(t,e){if(1&t){const t=a.Xb();a.Wb(0,"div",0),a.Wb(1,"nz-card"),a.Wb(2,"div",1),a.Wb(3,"div",2),a.Wb(4,"sf",3),a.dc("formSubmit",function(t){return e.submit(t)})("formReset",function(e){return a.Ac(t),a.xc(10).reset(e)}),a.Vb(),a.Vb(),a.Wb(5,"div",2),a.Wb(6,"button",4),a.dc("click",function(){return e.form()}),a.Kc(7,"\u65b0\u5efa"),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Vb(),a.Wb(8,"nz-card"),a.Rb(9,"st",5,6),a.Vb()}2&t&&(a.Cb(2),a.oc("nzGutter",a.rc(4,z)),a.Cb(2),a.oc("schema",e.searchSchema),a.Cb(5),a.oc("data",e.list)("columns",e.columns))},directives:[f.a,v.c,v.a,b.b,u.a,h.a,m.a,y.a],encapsulation:2}),t})()}];let W=(()=>{class t{}return t.\u0275mod=a.Ob({type:t}),t.\u0275inj=a.Nb({factory:function(e){return new(e||t)},imports:[[c.n.forChild(V)],c.n]}),t})(),k=(()=>{class t{}return t.\u0275mod=a.Ob({type:t}),t.\u0275inj=a.Nb({factory:function(e){return new(e||t)},imports:[[s.b,W]]}),t})()}}]);